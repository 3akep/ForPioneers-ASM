masm
model	small
stack	100h
delay macro time
	local	ext,iter
	push	cx
	mov	cx,time
ext:    push	cx
	mov	cx,10000
iter:   loop	iter
	pop	cx
	loop	ext
	pop	cx
endm
.data
tone	 dw	4063,4559,4559,1,3620,3225,2873,2712,2416,2280
	 dw	2416,2712,2712,1,2712,2712,3044,3417,3620,4063,3417
	 dw	3620,3620,4063,4559,3620,4063,4063,4063,5424,4599
	 dw	3620,3620,3620,4063,4559,4559,1,3620,3225,2873,2712
	 dw	2416,2280,2416,2712,2712,1,2712,2712,3044,3417,3620
	 dw	4063,3417,3620,3620,4063,4559,3620,4063,4063,4063
	 dw	5424,4599,3620,3620,3620,3620,3620,2712,2416,2280
	 dw	2416,2712,2416,2712,3044,2712,3620,3620,3620,3044
	 dw	2416,2280,2416,2712,2416,2712,3044,2416,2280,4063
	 dw	4559,4559,1,3620,3225,2873,2712,2416,2280,2416,2712
	 dw	2712,1,2712,2712,3044,3417,3620,4063,3417,3620,3620
	 dw	4063,4559,4559,3620,4063,4063,4063,5424,4599,3620,3620
	 dw	3620,3620,3620,2712,2416,2280,2416,2712,2416,2712
	 dw	3044,2712,3620,3620,3620,3044,2416,2280,2416,2712
	 dw	2416,2712,3044,2416,2280,4063,4559,4559,1,3620,3225
	 dw	2873,2712,2416,2280,2416,2712,2712,1,2712,2712,3044
	 dw	3417,3620,4063,3417,3620,3620,4063,4559,3620,4063
	 dw	4063,4063,5424,4559,3620,3620,3620,4559,3620,4063
	 dw	5424,4559,3620,3620,3620,9999
sound_title	db	'The Beatles - Yesterday',010,013,+'by Agapov Alexey','$'
.code
main:
	mov	ax,@data
	mov	ds,ax
	xor	ax,ax
	
	mov	ax,0600h
	mov	bh,0Eh
	mov	cx,0000h
	mov	dx,184Fh
	int	10h
	mov	ah,02h
	mov	bh,00
	mov	dh,00
	mov	dl,00
	int	10h
	mov	dx,offset sound_title
	mov	ah,9
	int	21h

	mov	al,0B6h
	out	43h,al
	in	al,61h
	or	al,3
	out	61h,al
	mov	bx,0
melody:
 	mov	ax,tone[bx]
	out	42h,al
	xchg	al,ah
	out	42h,al
	delay	10000
	add	bx,2
	cmp	tone[bx],9999
	jne	melody
nosound:
	in	al,61h
	and	al,0FCh
	out	61h,al
.exit
end main
